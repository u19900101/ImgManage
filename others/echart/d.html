<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>折线图的绘制</title>
    <script src="../../echarts.min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
</head>

<body>
    <div id="main" style="height: 600px;width:900px;"></div>
    <script>



        var gpsData_title = [];
        var heatMapData = [];
        //获取csv对象
        d3.csv("./333.csv", function (error, csvdata) {

            console.log("进入文件读取");
            if (error) {
                console.log(error);
            } else {

                for (var i = 0; i < csvdata.length; i++) {
                    heatMapData.push(
                        [csvdata[i].day,
                        // csvdata[i].title,
                        // csvdata[i].longitude,
                        // csvdata[i].latitude,
                        eval(csvdata[i].num)]
                    );           //对象转数组

                    gpsData_title.push([
                        csvdata[i].day,
                        csvdata[i].title,
                        csvdata[i].longitude,
                        csvdata[i].latitude,
                    ]
                    );
                }

                // console.log(infodata[0])
                // infodata = [
                //     ['2021-01-01', "s13", "1.3", 1],
                //     ['2021-02-01', "s13", "1.3", 2],
                //     ['2021-03-01', "s13", "1.3", 3],
                //     ['2021-04-01', "s13", "1.3", 4],
                //     ['2021-05-01', "s13", "1.3", 5],
                //     ['2021-06-01', "s13", "1.3", 6],
                //     ["2021-07-01", "s13", "1.3", 7],
                //     ['2021-08-01', "s13", "1.3", 8],
                //     ['2021-09-01',"s13", "1.3", 9],
                // ];
                // infodata = [
                //     ['2021-01-01',  1],
                //     ['2021-02-01',  2],
                //     ['2021-03-01',  3],
                //     ['2021-04-01',  4],
                //     ['2021-05-01',  5],
                //     ['2021-06-01',  6],
                //     ["2021-07-01",  7],
                //     ['2021-08-01',  8],
                //     ['2021-09-01',  9],
                // ];
                // console.log(infodata)
                var myChart = echarts.init(document.getElementById("main"));


                var option = {
                    //设置背景
                    //   backgroundColor: '#d0d0d0',
                    visualMap: {
                        // show: true,
                        min: 0,
                        max: 20,
                        inRange: {
                            color: ['#00c602'],
                            opacity: [0, 1]
                        },
                        controller: {
                            inRange: {
                                opacity: [0, 1]
                            },
                            outOfRange: {
                                color: '#ccc'
                            }
                        },
                        seriesIndex: [1],
                    },
                    title: {
                        top: 30,
                        text: '文章贡献度',
                        subtext: '一年内博客提交的数量',
                        left: 'center',
                        textStyle: {
                            color: '#000'
                        }
                    },
                    // legend: {
                    //     top: '30',
                    //     left: '100',
                    //     data: ['文章数', 'Top 12'],
                    //     textStyle: {
                    //         // 设置字体颜色
                    //         color: '#000'
                    //     }
                    // },
                    calendar: [{
                        top: 100,
                        left: 'center',
                        // range: contributeDate,
                        range: ['2020-07', '2021-12-31'],
                        splitLine: {
                            show: true,
                            lineStyle: {
                                // 设置月份分割线的颜色
                                color: '#ea0808',
                                width: 1,
                                type: 'solid'
                            }
                        },
                        yearLabel: { show: true },
                        dayLabel: {
                            nameMap: ["日", "一", "二", "三", "四", "五", "六"], // 设置中文显示
                            textStyle: {
                                // 设置周显示颜色
                                color: '#000'
                            },
                            firstDay: 7 // 从周一开始
                        },
                        monthLabel: {
                            nameMap: 'cn', // 设置中文显示
                            textStyle: {
                                // 设置月显示颜色
                                color: '#000'
                            }
                        },
                        // orient: 'vertical',
                        itemStyle: {
                            normal: {
                                // 设置背景颜色
                                color: '#ffffff',
                                borderWidth: 5,
                                // 设置方块分割线段颜色
                                borderColor: 'rgba(211,211,211,0)'
                            }
                        }
                    }],
                    tooltip: [{
                        trigger: 'item',
                        formatter: function (params) {
                            return ('时间：' + params.value[0] + '<br>文章数：' + params.value[1] +
                                "<br>标题：" + params.value[2] +
                                "<br>经度：" + params.value[3] + "<br>纬度: " + params.value[4])
                        }
                    }],

                    series: [{
                        type: 'heatmap',
                        name: '数量',
                        coordinateSystem: 'calendar',
                        data: gpsData_title,
                        // encode: {
                        //     tooltip: [0, 1, 2]
                        // },
                    }, {
                        type: 'heatmap',
                        name: '数量',
                        coordinateSystem: 'calendar',
                        data: heatMapData,
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    },]
                };
                myChart.setOption(option);
                myChart.on('click', function (params) {

                    // console.log(params);
                    console.log("时间:", params.value[0], "大小：", params.value[1],
                        "标题：", params.value[2],
                        "经度：", params.value[3], "纬度: ", params.value[4]);

                    // window.open('https://www.baidu.com/s?wd=' + encodeURIComponent(params.name));
                });
            }
        });
    </script>
</body>

</html>